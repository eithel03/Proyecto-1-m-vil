<ContentPage
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:viewmodels="clr-namespace:MiAgendaUTN.ViewModels"
    x:Class="MiAgendaUTN.Views.TasksPage"
    Title="Tareas"
    x:Name="TasksPageRoot"
    
    BindingContext="{StaticResource TaskVM}">

    <ContentPage.Resources>
        <Style x:Key="BaseButtonStyle" TargetType="Button">
            <Setter Property="CornerRadius" Value="15" />
            <Setter Property="FontSize" Value="12" />
            <Setter Property="Padding" Value="10, 5" />
            <Setter Property="MinimumWidthRequest" Value="80" />
            <Setter Property="HeightRequest" Value="35" />
            <Setter Property="FontAttributes" Value="Bold" />
        </Style>

        <Style x:Key="EditButtonStyle" TargetType="Button" BasedOn="{StaticResource BaseButtonStyle}">
            <Setter Property="BackgroundColor" Value="#1565C0" /> 
            <Setter Property="TextColor" Value="White" />
        </Style>
        
        <Style x:Key="DeleteButtonStyle" TargetType="Button" BasedOn="{StaticResource BaseButtonStyle}">
            <Setter Property="BackgroundColor" Value="#E53935" /> 
            <Setter Property="TextColor" Value="White" />
        </Style>
    </ContentPage.Resources>

    <CollectionView ItemsSource="{Binding Tasks}">
        <CollectionView.ItemTemplate>
            <DataTemplate>
                <Frame 
                    CornerRadius="8" 
                    BorderColor="#CFE2F3"  
                    HasShadow="True" 
                    Margin="10, 5" 
                    Padding="15"
                    BackgroundColor="White">
                    
                    <VerticalStackLayout Spacing="5">
                        <Label 
                            Text="{Binding Title}" 
                            FontAttributes="Bold" 
                            FontSize="16" 
                            TextColor="#0D47A1" /> 
                        
                        <Label 
                            Text="{Binding Description}" 
                            FontSize="13" 
                            TextColor="Gray" 
                            LineBreakMode="WordWrap" />
                        
                        <Label 
                            Text="{Binding DueDate, StringFormat='Fecha lÃ­mite: {0:dd/MM/yyyy}'}" 
                            FontSize="11" 
                            TextColor="#1565C0" 
                            Margin="0, 5, 0, 0" />

                        <HorizontalStackLayout Spacing="10" Margin="0,10,0,0" HorizontalOptions="End">
                            <Button
                                Text="Editar"
                                Style="{StaticResource EditButtonStyle}"
                                Command="{Binding Source={x:Reference TasksPageRoot}, Path=BindingContext.SelectForEditCommand}"
                                CommandParameter="{Binding .}" />

                            <Button
                                Text="Eliminar"
                                Style="{StaticResource DeleteButtonStyle}"
                                Command="{Binding Source={x:Reference TasksPageRoot}, Path=BindingContext.DeleteTaskCommand}"
                                CommandParameter="{Binding .}" />
                        </HorizontalStackLayout>
                    </VerticalStackLayout>
                </Frame>
            </DataTemplate>
        </CollectionView.ItemTemplate>
    </CollectionView>

    </ContentPage>